# å‰è¨€

æ®è¯´é˜¿é‡Œæœ‰ä¸€é“é¢è¯•é¢˜å°±æ˜¯è°ˆè°ˆ**å‡½æ•°èŠ‚æµ**å’Œ**å‡½æ•°é˜²æŠ–**ã€‚

ç³Ÿäº†ï¼Œè¿™å¯è§¦ç¢°åˆ°æˆ‘çš„çŸ¥è¯†ç›²åŒºäº†ï¼Œå¥½åƒå¬ä¹Ÿæ²¡å¬è¿‡è¿™ 2 ä¸ªä¸œè¥¿ï¼Œç—›å®šæ€ç—›ï¼Œèµ¶ç´§å­¦ä¹ å­¦ä¹ ã€‚here we goï¼

![](http://cdn.chenrf.com/fe/30827d47cc87840db33b326d151ee63e.jpg)

# æ¦‚å¿µå’Œä¾‹å­

### å‡½æ•°é˜²æŠ– (debounce)

> åœ¨äº‹ä»¶è¢«è§¦å‘ n ç§’åå†æ‰§è¡Œå›è°ƒï¼Œå¦‚æœåœ¨è¿™ n ç§’å†…åˆè¢«è§¦å‘ï¼Œåˆ™é‡æ–°è®¡æ—¶ã€‚

çœ‹ä¸€ä¸ªğŸŒ°ï¼ˆæ —å­ï¼‰ï¼š

```
//æ¨¡æ‹Ÿä¸€æ®µajaxè¯·æ±‚
function ajax(content) {
  console.log('ajax request ' + content)
}

let inputa = document.getElementById('unDebounce')

inputa.addEventListener('keyup', function (e) {
    ajax(e.target.value)
})
```

çœ‹ä¸€ä¸‹è¿è¡Œç»“æœï¼š

![](http://cdn.chenrf.com/fe/9c6994ff51588a220ec385e3e292a934.gif)

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åªè¦æŒ‰ä¸‹é”®ç›˜ï¼Œå°±ä¼šè§¦å‘è¿™æ¬¡ ajax è¯·æ±‚ã€‚ä¸ä»…ä»èµ„æºä¸Šæ¥è¯´æ˜¯å¾ˆæµªè´¹çš„è¡Œä¸ºï¼Œè€Œä¸”å®é™…åº”ç”¨ä¸­ï¼Œç”¨æˆ·ä¹Ÿæ˜¯è¾“å‡ºå®Œæ•´çš„å­—ç¬¦åï¼Œæ‰ä¼šè¯·æ±‚ã€‚ä¸‹é¢æˆ‘ä»¬ä¼˜åŒ–ä¸€ä¸‹ï¼š

```
//æ¨¡æ‹Ÿä¸€æ®µajaxè¯·æ±‚
function ajax(content) {
  console.log('ajax request ' + content)
}

function debounce(fun, delay) {
    return function (args) {
        let that = this
        let _args = args
        clearTimeout(fun.id)
        fun.id = setTimeout(function () {
            fun.call(that, _args)
        }, delay)
    }
}

let inputb = document.getElementById('debounce')

let debounceAjax = debounce(ajax, 500)

inputb.addEventListener('keyup', function (e) {
    debounceAjax(e.target.value)
})
```

çœ‹ä¸€ä¸‹è¿è¡Œç»“æœï¼š

![](http://cdn.chenrf.com/fe/a8fa9294b85ef4566913a1703f64dc37.gif)

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åŠ å…¥äº†é˜²æŠ–ä»¥åï¼Œå½“ä½ åœ¨é¢‘ç¹çš„è¾“å…¥æ—¶ï¼Œå¹¶ä¸ä¼šå‘é€è¯·æ±‚ï¼Œåªæœ‰å½“ä½ åœ¨æŒ‡å®šé—´éš”å†…æ²¡æœ‰è¾“å…¥æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œå‡½æ•°ã€‚å¦‚æœåœæ­¢è¾“å…¥ä½†æ˜¯åœ¨æŒ‡å®šé—´éš”å†…åˆè¾“å…¥ï¼Œä¼šé‡æ–°è§¦å‘è®¡æ—¶ã€‚

å†çœ‹ä¸€ä¸ªğŸŒ°ï¼š

``` 
let biu = function () {
    console.log('biu biu biu',new Date().Format('HH:mm:ss'))
}

let boom = function () {
    console.log('boom boom boom',new Date().Format('HH:mm:ss'))
}

setInterval(debounce(biu,500),1000)
setInterval(debounce(boom,2000),1000)
```

çœ‹ä¸€ä¸‹è¿è¡Œç»“æœï¼š

![](http://cdn.chenrf.com/fe/39086c2c76538cec9fa457f4e6054e1b.gif)

è¿™ä¸ªğŸŒ°å°±å¾ˆå¥½çš„è§£é‡Šäº†ï¼Œå¦‚æœåœ¨æ—¶é—´é—´éš”å†…æ‰§è¡Œå‡½æ•°ï¼Œä¼šé‡æ–°è§¦å‘è®¡æ—¶ã€‚biu ä¼šåœ¨ç¬¬ä¸€æ¬¡ 1.5s æ‰§è¡Œåï¼Œæ¯éš” 1s æ‰§è¡Œä¸€æ¬¡ï¼Œè€Œ boom ä¸€æ¬¡ä¹Ÿä¸ä¼šæ‰§è¡Œã€‚å› ä¸ºå®ƒçš„æ—¶é—´é—´éš”æ˜¯ 2sï¼Œè€Œæ‰§è¡Œæ—¶é—´æ˜¯ 1sï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½ä¼šé‡æ–°è§¦å‘è®¡æ—¶

> ä¸ªäººç†è§£ å‡½æ•°é˜²æŠ–å°±æ˜¯æ³•å¸ˆå‘æŠ€èƒ½çš„æ—¶å€™è¦è¯»æ¡ï¼ŒæŠ€èƒ½è¯»æ¡æ²¡å®Œå†æŒ‰æŠ€èƒ½å°±ä¼šé‡æ–°è¯»æ¡ã€‚

### å‡½æ•°èŠ‚æµ (throttle)

> è§„å®šåœ¨ä¸€ä¸ªå•ä½æ—¶é—´å†…ï¼Œåªèƒ½è§¦å‘ä¸€æ¬¡å‡½æ•°ã€‚å¦‚æœè¿™ä¸ªå•ä½æ—¶é—´å†…è§¦å‘å¤šæ¬¡å‡½æ•°ï¼Œåªæœ‰ä¸€æ¬¡ç”Ÿæ•ˆã€‚

çœ‹ä¸€ä¸ªğŸŒ°ï¼š

```
function throttle(fun, delay) {
    let last, deferTimer
    return function (args) {
        let that = this
        let _args = arguments
        let now = +new Date()
        if (last && now < last + delay) {
            clearTimeout(deferTimer)
            deferTimer = setTimeout(function () {
                last = now
                fun.apply(that, _args)
            }, delay)
        }else {
            last = now
            fun.apply(that,_args)
        }
    }
}

let throttleAjax = throttle(ajax, 1000)

let inputc = document.getElementById('throttle')
inputc.addEventListener('keyup', function(e) {
    throttleAjax(e.target.value)
})
```

çœ‹ä¸€ä¸‹è¿è¡Œç»“æœï¼š

![](http://cdn.chenrf.com/fe/6e46691a52f227a94205d25489b05fe1.gif)

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨ä¸æ–­è¾“å…¥æ—¶ï¼Œajax ä¼šæŒ‰ç…§æˆ‘ä»¬è®¾å®šçš„æ—¶é—´ï¼Œæ¯ 1s æ‰§è¡Œä¸€æ¬¡ã€‚

ç»“åˆåˆšåˆš biubiubiu çš„ğŸŒ°ï¼š

```
let biubiu = function () {
    console.log('biu biu biu', new Date().Format('HH:mm:ss'))
}

setInterval(throttle(biubiu,1000),10)
```

![](http://cdn.chenrf.com/fe/a2e657bc60a5b4a2ed83aec4cc6838a9.gif)

ä¸ç®¡æˆ‘ä»¬è®¾å®šçš„æ‰§è¡Œæ—¶é—´é—´éš”å¤šå°ï¼Œæ€»æ˜¯ 1s å†…åªæ‰§è¡Œä¸€æ¬¡ã€‚

> ä¸ªäººç†è§£ å‡½æ•°èŠ‚æµå°±æ˜¯ fps æ¸¸æˆçš„å°„é€Ÿï¼Œå°±ç®—ä¸€ç›´æŒ‰ç€é¼ æ ‡å°„å‡»ï¼Œä¹Ÿåªä¼šåœ¨è§„å®šå°„é€Ÿå†…å°„å‡ºå­å¼¹ã€‚

# æ€»ç»“

* å‡½æ•°é˜²æŠ–å’Œå‡½æ•°èŠ‚æµéƒ½æ˜¯é˜²æ­¢æŸä¸€æ—¶é—´é¢‘ç¹è§¦å‘ï¼Œä½†æ˜¯è¿™ä¸¤å…„å¼Ÿä¹‹é—´çš„åŸç†å´ä¸ä¸€æ ·ã€‚
* å‡½æ•°é˜²æŠ–æ˜¯æŸä¸€æ®µæ—¶é—´å†…åªæ‰§è¡Œä¸€æ¬¡ï¼Œè€Œå‡½æ•°èŠ‚æµæ˜¯é—´éš”æ—¶é—´æ‰§è¡Œã€‚

### ç»“åˆåº”ç”¨åœºæ™¯

*  debounce
    *  search æœç´¢è”æƒ³ï¼Œç”¨æˆ·åœ¨ä¸æ–­è¾“å…¥å€¼æ—¶ï¼Œç”¨é˜²æŠ–æ¥èŠ‚çº¦è¯·æ±‚èµ„æºã€‚
    *  window è§¦å‘ resize çš„æ—¶å€™ï¼Œä¸æ–­çš„è°ƒæ•´æµè§ˆå™¨çª—å£å¤§å°ä¼šä¸æ–­çš„è§¦å‘è¿™ä¸ªäº‹ä»¶ï¼Œç”¨é˜²æŠ–æ¥è®©å…¶åªè§¦å‘ä¸€æ¬¡
*  throttle
    *  é¼ æ ‡ä¸æ–­ç‚¹å‡»è§¦å‘ï¼Œmousedown(å•ä½æ—¶é—´å†…åªè§¦å‘ä¸€æ¬¡)
    *  ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œæ¯”å¦‚æ˜¯å¦æ»‘åˆ°åº•éƒ¨è‡ªåŠ¨åŠ è½½æ›´å¤šï¼Œç”¨ throttle æ¥åˆ¤æ–­

# æ‹“å±•

> å‚è€ƒé“¾æ¥ï¼š[http://www.cnblogs.com/zichi/p/5331426.html](http://www.cnblogs.com/zichi/p/5331426.html)

![](http://cdn.chenrf.com/fe/20990d8be26b98e4c5e723f3bedcf6bb.jpg)

è¿™æ˜¯é«˜ç¨‹ä¸­çš„ç»å…¸ä»£ç ï¼š

```
function throttle(method, context) {
    clearTimeout(method.tId);
    method.tId = setTimeout(function () {
        method.call(context);
    }, 100)
}
```

æˆ‘ä»¬é€šè¿‡ä¸Šé¢çš„ä¾‹å­çŸ¥é“ï¼Œå…¶å®è¿™æ®µå‡½æ•°åº”è¯¥æ˜¯ debounce å‡½æ•°é˜²æŠ–ï¼Œè€Œä¸æ˜¯å‡½æ•°èŠ‚æµï¼Œå¾ˆå¤šæ–‡ç« ä¹Ÿéƒ½ä¼šæ‹¿è¿™æ®µä»£ç æ¥åšä¾‹å­ï¼Œå‡½æ•°æœ¬èº«æ²¡é”™ï¼Œä½†æ˜¯å‘½åé”™äº†ã€‚

**åŸä½œè€…çš„è¿™æ®µè¯å°±å†™çš„å¾ˆå¥½ï¼š**

å°±ä»¥ throttle ä¸ºä¾‹ï¼ŒæŸæ—¥ï¼Œè€å¸ˆç»™ä½ å¸ƒç½®äº†ä¸€ä¸ªä½œä¸šï¼Œè®©ä½ æ·±å…¥ç†è§£ä¸€ä¸‹ throttleï¼Œç¬¬äºŒå¤©ä¸Šè¯¾æ¥èŠèŠã€‚å¼ ä¸‰å¿ƒé‡Œéå¸¸é«˜å…´ï¼Œè¿™ä¸ªæ¦‚å¿µåœ¨ç»å…¸ä¹¦ç±ã€ŠJavaScript é«˜çº§ç¨‹åºè®¾è®¡ã€‹ä¸­è§è¿‡ï¼Œæ‰“å¼€ä¸€çœ‹ï¼Œå°±ä¸¤é¡µï¼Œè€Œä¸”è§£é‡Šåœ°éå¸¸æ¸…æ™°ï¼Œçœ‹å®Œå°±é«˜å…´åœ°å¹²åˆ«çš„äº‹æƒ…å»äº†ã€‚è€Œæå››ï¼Œè§‰å¾—é«˜ç¨‹ä¸‰è®²çš„æœ‰ç‚¹å°‘ï¼Œè€Œå»è°·æ­Œäº†ä¸‹å…¶ä»–å…³äº throttle çš„çŸ¥è¯†ç‚¹ï¼Œå…´å¥‹åœ°çœ‹åˆ° throttle å‡½æ•°çš„å¥½å‡ ç§å†™æ³•ï¼Œå‘ç°é«˜ç¨‹ä¸‰åªæ˜¯ç”¨äº†æœ€ç®€å•çš„æ–¹å¼ï¼Œè¿˜æœ‰æ›´ä¼˜é›…è¿ç”¨åœºæ™¯æ›´å¤šçš„å†™æ³•ï¼Œæˆ–è®¸æ­¤æ—¶ä»–å·²ç»å‘ç°å’Œ throttle åŒæ—¶å‡ºç°çš„è¿˜æœ‰ä¸ª debounceï¼Œè¿™æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿåæ­£è€å¸ˆæ²¡è¯´ï¼Œä»¥åå†çœ‹å§ï¼Œäºæ˜¯å¿ƒæ»¡æ„è¶³åœ°ç©æ¸¸æˆå»äº†ã€‚è€Œç‹äº”ï¼Œå’Œæå››ä¸€æ ·å‘ç°äº† debounceï¼Œè¿™æ˜¯ä»€ä¹ˆï¼Ÿä¸€èµ·äº†è§£äº†å§ï¼Œç»§è€Œå‘ç° debounce çš„ç”¨æ³•å±…ç„¶å’Œé«˜ç¨‹ä¸‰ä¸­çš„ throttle ä¸€æ ·ï¼ç»§ç»­æŒ–ä¸‹å»ï¼Œå‘ç°é«˜ç¨‹ä¸‰ä¸­çš„ throttle å‡½æ•°å…¶å®åº”è¯¥å« debounceï¼Œçœ‹åˆ°æœ€åï¼Œç‹äº”å·²ç»æŠŠ throttle å’Œ debounce å½»åº•ç†è§£äº†ã€‚

æˆ‘ä»¬è¦åšç‹äº”ã€‚

> æœ¬æ–‡æ¥è‡ª@xiyanxinï¼Œåœ°å€ï¼šhttps://github.com/Xpig4432xyx/blog/issues/3